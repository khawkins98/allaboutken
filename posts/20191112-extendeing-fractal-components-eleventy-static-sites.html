<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="x-ua-compatible" content="ie=edge"> <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes"> <title>Fractal and Eleventy: Getting static sites closer to the design system > All about Ken</title> <style type="text/css">div,h1,li,p,ul{margin:0;padding:0}h1{font-family:ibm-plex-sans,"Fira Sans",Arial,sans-serif;font-style:normal;font-weight:800;color:inherit;text-rendering:optimizeLegibility}h1 small{line-height:0;color:#cacaca}h1.tight-leading{line-height:2rem}h1>small{color:#fefefe;font-size:1.5rem;display:inline-block;font-weight:400}html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}a{background-color:transparent;-webkit-text-decoration-skip:objects}strong{font-weight:inherit}strong{font-weight:bolder}code{font-family:monospace,monospace;font-size:1em}small{font-size:80%}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{box-sizing:border-box;font-size:110%}*,::after,::before{box-sizing:inherit}body{margin:0;padding:0;background:#7759c3;font-family:ibm-plex-sans,"Fira Sans",Arial,sans-serif;font-weight:400;line-height:1.5;color:#fefefe;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.grid-container{padding-right:.56818rem;padding-left:.56818rem;max-width:71.02273rem;margin:0 auto}.grid-x{display:-ms-flexbox;display:flex;-ms-flex-flow:row wrap;flex-flow:row wrap}.cell{-ms-flex:0 0 auto;flex:0 0 auto;min-height:0;min-width:0;width:100%}.cell.auto{-ms-flex:1 1 0px;flex:1 1 0px}.grid-x>.auto{width:auto}.grid-x>.small-12{-ms-flex-preferred-size:auto;flex-basis:auto}.grid-x>.small-12{width:100%}.grid-padding-x .grid-padding-x{margin-right:-.56818rem;margin-left:-.56818rem}.grid-container:not(.full)>.grid-padding-x{margin-right:-.56818rem;margin-left:-.56818rem}.grid-padding-x>.cell{padding-right:.56818rem;padding-left:.56818rem}@media print,screen and (min-width:40em){.grid-container{padding-right:.85227rem;padding-left:.85227rem}.grid-x>.medium-1,.grid-x>.medium-10,.grid-x>.medium-5{-ms-flex-preferred-size:auto;flex-basis:auto}.grid-x>.medium-1{width:8.33333%}.grid-x>.medium-5{width:41.66667%}.grid-x>.medium-10{width:83.33333%}.grid-padding-x .grid-padding-x{margin-right:-.85227rem;margin-left:-.85227rem}.grid-container:not(.full)>.grid-padding-x{margin-right:-.85227rem;margin-left:-.85227rem}.grid-padding-x>.cell{padding-right:.85227rem;padding-left:.85227rem}}.small-up-1>.cell{width:100%}div,h1,h2,h3,li,p,ul{margin:0;padding:0}p{margin-bottom:1rem;font-size:inherit;line-height:1.6;text-rendering:optimizeLegibility}strong{font-weight:800;line-height:inherit}small{font-size:80%;line-height:inherit}h1,h2,h3{font-family:ibm-plex-sans,"Fira Sans",Arial,sans-serif;font-style:normal;font-weight:800;color:inherit;text-rendering:optimizeLegibility}h1 small,h2 small{line-height:0;color:#cacaca}h1{font-size:1.36364rem;line-height:1.4;margin-top:0;margin-bottom:.5rem}h2{font-size:1.13636rem;line-height:1.4;margin-top:0;margin-bottom:.5rem}h3{font-size:1.07955rem;line-height:1.4;margin-top:0;margin-bottom:.5rem}@media print,screen and (min-width:40em){.medium-up-4>.cell{width:25%}h1{font-size:3.63636rem}h2{font-size:2.27273rem}h3{font-size:1.76136rem}}a{line-height:inherit;color:#7759c3;text-decoration:none}hr{clear:both;max-width:71.02273rem;height:0;margin:1.13636rem auto;border-top:0;border-right:0;border-bottom:1px solid #cacaca;border-left:0}ul{margin-bottom:1rem;list-style-position:outside;line-height:1.6}li{font-size:inherit}ul{margin-left:1.25rem;list-style-type:disc}code{padding:.11364rem .28409rem .05682rem;border:none;background-color:rgba(254,254,254,.1);font-family:ibm-plex-code,"Fira Code",Courier,monospace;font-weight:400;color:#fefefe}.menu{padding:0;margin:0;list-style:none;position:relative;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.menu a{line-height:1;text-decoration:none;display:block;padding:.7rem 1rem}.menu a{margin-bottom:0}.menu{-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-direction:row;flex-direction:row}.menu .is-active>a{background:#7759c3;color:#fefefe}@media screen and (max-width:39.9375em){.show-for-medium{display:none!important}}@media screen and (max-width:39.9375em),screen and (min-width:75em){.show-for-medium-only{display:none!important}}@media screen and (max-width:74.9375em){.show-for-large{display:none!important}}html{background:#000}hr{display:block;height:1px;border:0;border-top:1px solid #ccc;margin:1em 0;padding:0}.no-bullet ul{list-style-type:none;text-indent:-1rem}.main-content-area a:link,.main-content-area a:visited{color:inherit}.main-content-area a:link{text-decoration:none;background:linear-gradient(#7759c3,#7759c3),linear-gradient(#7759c3,#7759c3),linear-gradient(#fff,#fff);background-size:.05em 1px,.05em 1px,1px 1px;background-repeat:no-repeat,no-repeat,repeat-x;background-position:0 93%,100% 93%,0 93%}@media screen and (-webkit-min-device-pixel-ratio:0){.main-content-area a:link{background-position-y:87%,87%,87%}}@media (max-width:760px){ul{width:85%}}.margin-top-none{margin-top:0}.margin-top-xlarge{margin-top:2rem}.margin-bottom-none{margin-bottom:0}.margin-bottom-xlarge{margin-bottom:2rem}.padding-top-xlarge{padding-top:2rem}.padding-bottom-medium{padding-bottom:.5rem}.padding-bottom-xlarge{padding-bottom:2rem}.float-right{float:right}.float-left{float:left}.black-background{background:#0a0a0a}.emoji{font-family:Noto-Emoji}body.gradient{background:linear-gradient(to bottom,#7759c3 0,#2970ad 99%)}code{font-size:.8rem}h1{font-size:3rem}h2{font-size:2.36364rem}h3{font-size:1.2rem}.block{display:block}a.only-hover:link{background:0 0}.menu li a{color:#fefefe}.menu .is-active>a{background:#444;color:#fefefe}h1.tight-leading,h2.tight-leading{line-height:2rem}h1>small,h2>small{color:#fefefe;font-size:1.5rem;display:inline-block;font-weight:400}strong{letter-spacing:.5px}@media screen{.show-for-print-only{display:none}}.emoji{font-weight:400!important} </style> <link rel="preload" href="https://khawkins98.github.io/allaboutken-framework/css/allaboutken-framework.css" as="style" onload="this.rel='stylesheet'"> <noscript><link rel="stylesheet" href="https://khawkins98.github.io/allaboutken-framework/css/allaboutken-framework.css"></noscript> <link rel="preload" href="../app.css" as="style" onload="this.rel='stylesheet'"> <noscript><link rel="stylesheet" href="../app.css"></noscript> <script>!function(e){"use strict";var t=function(t,n,r){function o(e){if(i.body)return e();setTimeout(function(){o(e)})}function a(){d.addEventListener&&d.removeEventListener("load",a),d.media=r||"all"}var l,i=e.document,d=i.createElement("link");if(n)l=n;else{var s=(i.body||i.getElementsByTagName("head")[0]).childNodes;l=s[s.length-1]}var u=i.styleSheets;d.rel="stylesheet",d.href=t,d.media="only x",o(function(){l.parentNode.insertBefore(d,n?l:l.nextSibling)});var f=function(e){for(var t=d.href,n=u.length;n--;)if(u[n].href===t)return e();setTimeout(function(){f(e)})};return d.addEventListener&&d.addEventListener("load",a),d.onloadcssdefined=f,f(a),d};"undefined"!=typeof exports?exports.loadCSS=t:e.loadCSS=t}("undefined"!=typeof global?global:this),function(e){if(e.loadCSS){var t=loadCSS.relpreload={};if(t.support=function(){try{return e.document.createElement("link").relList.supports("preload")}catch(e){return!1}},t.poly=function(){for(var t=e.document.getElementsByTagName("link"),n=0;n<t.length;n++){var r=t[n];"preload"===r.rel&&"style"===r.getAttribute("as")&&(e.loadCSS(r.href,r,r.getAttribute("media")),r.rel=null)}},!t.support()){t.poly();var n=e.setInterval(t.poly,300);e.addEventListener&&e.addEventListener("load",function(){t.poly(),e.clearInterval(n)}),e.attachEvent&&e.attachEvent("onload",function(){e.clearInterval(n)})}}}(this);</script> <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png?v=kPxQgGG9A2"> <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png?v=kPxQgGG9A2"> <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png?v=kPxQgGG9A2"> <link rel="manifest" href="/manifest.json?v=kPxQgGG9A2"> <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg?v=kPxQgGG9A2" color="#7759c3"> <link rel="shortcut icon" href="/favicon.ico?v=kPxQgGG9A2"> <meta name="theme-color" content="#7759c3"> <meta name="description" content="Hello. I am Ken Hawkins. Builder of websites, project planner, newspaper nerd, information architect, lover of UX, consultant. Information structure is my thing."> <meta name="MobileOptimized" content="width"> <meta name="HandheldFriendly" content="true"> <meta name="abstract" content="Hello. I am Ken Hawkins. Builder of websites, project planner, newspaper nerd, information architect, lover of UX, consultant. Information structure is my thing."> <meta name="apple-mobile-web-app-capable" content="yes"> <meta name="keywords" content="Drupal, web development, Ken Hawkins, UX, information architecture"> <!-- <link rel="canonical" href="http://allaboutken.com/" />
    <link rel="shortlink" href="http://allaboutken.com/" /> --> <meta property="og:type" content="website"> <meta property="og:site_name" content="All About Ken Hawkins"> <meta property="og:url" content="https://work.allaboutken.com/"> <meta property="og:title" content="Fractal and Eleventy: Getting static sites closer to the design system > All About Ken Hawkins"> <meta property="og:image" content="https://work.allaboutken.com/images/crop-cinema/blog/fractal-eleventy.jpg"> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="@khawkins98"> <meta name="twitter:site:id" content="3723201"> <meta name="twitter:creator" content="@khawkins98"> <meta name="twitter:creator:id" content="3723201"> <meta name="twitter:url" content="https://work.allaboutken.com/"> <meta name="twitter:description" content="For the &lt;a href&#x3D;&#x27;https://visual-framework.github.io/vf-welcome/&#x27;&gt;Visual Framework 2.0&lt;/a&gt; component system we recommend &lt;a href&#x3D;&#x27;https://www.11ty.io&#x27;&gt;Eleventy&lt;/a&gt; for static sites: Eleventy sites get direct access to component templates with associated metadata and a focused component library."> <meta name="twitter:image" content="https://work.allaboutken.com/images/crop-cinema/blog/fractal-eleventy.jpg"> <meta name="dcterms.title" content="Fractal and Eleventy: Getting static sites closer to the design system > All About Ken Hawkins"> <meta name="dcterms.type" content="Text"> <meta name="dcterms.identifier" content="http://allaboutken.com/"> <meta name="dcterms.format" content="text/html"> <link rel="alternate" type="application/rss+xml" title="RSS" href="http://work.allaboutken.com/rss.xml"> <script src="/sw-register.js"></script> </head> <body class="gradient"> <div class="grid-x grid-padding-x black-background"> <div class="medium-1 show-for-medium cell do-not-print"></div> <div class="small-12 medium-10 cell"> <div class="grid-x do-not-print"> <div class="cell medium-5"> <ul class="menu float-left"> <li class=""><a href="../">AllAboutKen<span class="show-for-large">.com</span></a> </li> <li class="is-active"><a href="../blog">Blog</a></li> </ul> </div> <div class="cell auto"> <ul class="menu float-right show-for-medium"> <!-- <span class="dev-explainer">Would have been easy enough to just do icons here, but text is not only better SEO but there's not mystery as to the action of what these links do.</span> --> <li class="show-for-medium-only"><a href="mailto:khawkins98@gmail.com">E-mail</a></li> <li class="show-for-large"><a href="mailto:khawkins98@gmail.com">khawkins98@gmail.com</a></li> <li class=""><a href="https://twitter.com/khawkins98">Twitter<span class="show-for-large"> @khawkins98</span></a></li> <li class=""><a href="https://www.linkedin.com/in/allaboutken">LinkedIn</a></li> </ul> </div> </div> </div> </div> <div class="grid-container"> <div class="grid-x grid-padding-x main-content-area" id="main-content-area"> <div class="medium-1 show-for-medium cell do-not-print"></div> <div class="small-12 medium-10 print-12 cell"> <div class="medium-12 cell padding-top-large"> <div class="grid-x padding-bottom-medium padding-top-large padding-bottom-large"> <figure class="large-10 medium-8 cell callout"><img class="padding-bottom-medium" alt="Tightly pairing Fractal and Eleventy can be done" src="../images/original/blog/fractal-eleventy.jpg"> <figcaption>What you get out of the box when you use the Visual Framework's boilerplate for Eleventy: static site development with a Fractal component library running in the same process. When you update a Fractal component, so does the Eleventy build.</figcaption> </figure> </div> <p>2019.11.12 ¬† ¬†<span class="label">Filed in: gulp, Eleventy, EMBL, Fractal, Visual Framework</span></p> <div class="grid-x"> <div class="large-11 medium-12 cell"> <h1>Fractal and Eleventy: Getting static sites closer to the design system</h1> </div> </div> <p class="lead">For the <a href="https://visual-framework.github.io/vf-welcome/">Visual Framework 2.0</a> component system we recommend <a href="https://www.11ty.io">Eleventy</a> for static sites: Eleventy sites get direct access to component templates with associated metadata and a focused component library.</p> <p>This combo eases site building by giving developers visibility on Fractal templates and documentation in their particular install. The integration also allows project-level <a href="https://fractal.build/">Fractal</a> components that can extend core Sass and re-use component templates, with full access to Fractal <code>{% render %}</code> tags, context data, and other component metadata.</p> <p>Features:</p> <ul> <li>Eleventy static sites</li> <li>Fractal components can be <code>npm install</code>-ed</li> <li>Fractal Nunjucks templates and component data</li> <li>Local project-level components and templates can be added, and run in the same Fractal environment</li> <li>Fractal web UI with local instance components, documentation</li> </ul> <p>Heard enough? <a href="https://github.com/visual-framework/vf-eleventy">Try it out at visual-framework/vf-eleventy</a>.</p> <p>The two tools don't work like this by default, but I'll share how we've made it happen.</p> <h2>How it feels</h2> <p><img src="../images/original/blog/fractal-elventy-gulp-cycle.gif" alt="animated-GIF that shows how the Fractal components and Eleventy content are united"></p> <p><em>A 16-second animated-GIF that shows how the Fractal components and Eleventy content are united.</em></p> <p>Here's what's happening:</p> <ol> <li>Unified templating: Add a Fractal Nunjucks template to an Eleventy page</li> <li>A unified Eleventy-Fractal watch process: Update a Fractal Nunjucks template and Eleventy rebuilds</li> <li>Assets are also integrated: Update a component's Sass and gulp asks Eleventy to rebuild</li> </ol> <h2>How it works</h2> <p>For component management of the <a href="https://github.com/visual-framework/vf-core">Visual Framework 2.0</a>, we‚Äôve used the Node JS-based <a href="https://fractal.build/">Fractal</a> ‚Äî it ticks a lot of boxes for what we needed, including support for <a href="https://mozilla.github.io/nunjucks/">Nunjucks templating</a>. That templating allows the Visual Framework component system to stay relatively agnostic of technology.</p> <p><a href="https://github.com/visual-framework/vf-eleventy">Eleventy</a> is also Node JS-based and can use Nunjucks templating.</p> <p>We were really excited by this in initial discussions as we can use similar build environments and templates across our component library and static-site generator.</p> <p>Here's a high-level diagram:</p> <p><img src="../images/original/blog/fractal-vf-eleventy-architecture.svg" alt="Diagram of how Eleventy and Fractal talk"></p> <p><em>When the developer runs <code>gulp dev</code> it allows Fractal and Eleventy to run as child process of gulp, sharing a Nunjucks environment.</em></p> <p>There were a couple of <em>gotchas</em> that we had to work around, if you're interested in how we got there, read on, otherwise <a href="https://github.com/visual-framework/vf-eleventy">I suggest you just try out the <code>vf-eleventy</code> boilerplate</a>.</p> <h2>Making it happen</h2> <h3>All the same, but not</h3> <p>When attempting to achieve our flow, we quickly found issues as we weren't able to directly use our <code>npm install</code>-ed components in Eleventy for two reasons:</p> <ol> <li><p>Eleventy <a href="https://www.11ty.io/docs/languages/nunjucks/">wants to look</a> in a single place for our templates and we want to individually install components from <code>npm</code> a la: <code>yarn add --dev @visual-framework/vf-button</code></p> <p>We could work around this by some fancy copy-and-paste task that scans <code>node_modules</code> and copies <code>**/*.njk</code> to the directory used by Eleventy. Unpleasant, but possible.</p></li> <li><p>The Nunjucks template syntax isn‚Äôt exactly the same between the Fractal and Eleventy. The <a href="https://designsystem.digital.gov/documentation/developers/">United States Web Design System</a> also uses Fractal and <a href="https://github.com/uswds/uswds#template-compatibility">notes</a>:</p> <blockquote> <p>Components that reference other components use a Fractal-specific <code>{% render %}</code> tag that will either need to be implemented in other environments or replaced with the appropriate <code>{% include %}</code> tags.</p> </blockquote> <p>Which means using nested container-level templates ‚Äî like using a <code>logo</code> component inside a <code>page-header</code> template ‚Äî is out, unless you have one set of templates for Fractal and one for &quot;generic&quot; Nunjucks environments. While replacing <code>render</code> with <code>include</code> might seem trivial at first, there are issues around path lookups and other whack-a-mole issues with other Njk tags.</p></li> </ol> <p>Maintaining two sets of templates adds significant overhead and a large risk for typos and tests, it would also prevent us from being able to <code>yarn add</code> components.</p> <p>But there's a way to sidestep both of these issues.</p> <h3>Playing nice</h3> <p>We can avoid both of these by resolving Eleventy's expectation to run in a separate Node process.</p> <p>Fractal has already prepared a list of all the components (Issue 1) and made available the custom Nunjucks templates (Issue 2), if we can get Eleventy to use (and extend) the same Node process as Fractal's Nunjucks environment we'll get all the benefits outlined above.</p> <p>To do this we‚Äôve had to make a couple tweaks to how Eleventy executes; here's a summary:</p> <ol> <li>We forked Eleventy's <code>cmd.js</code> to so we can use it as a child task (i.e. <code>elev.write().then</code>)</li> <li>Gulp triggers the build of Fractal and then Eleventy</li> <li>Utilise Eleventy‚Äôs watch and refresh commands for local development</li> <li>Send variables to Eleventy‚Äôs JavaScript data files from Gulp (or other Node JS tasks)</li> </ol> <p>I took <a href="https://work.allaboutken.com/posts/20191021-integrating-eleventy-with-gulp.html">a deeper look at this approach in a separate blog post</a>.</p> <h2>Links</h2> <ul> <li><a href="https://github.com/visual-framework/vf-eleventy">Try this out with visual-framework/vf-eleventy</a></li> <li><a href="https://work.allaboutken.com/posts/20191021-integrating-eleventy-with-gulp.html">How we connect Eleventy with Gulp</a></li> <li><a href="https://github.com/visual-framework/vf-core#the-visual-framework-core-vf-core">How we use fractal with <code>vf-core</code></a></li> <li><a href="https://visual-framework.github.io/vf-welcome/">About the Visual Framework 2.0</a></li> </ul> </div> <div class="margin-top-xlarge padding-top-xlarge"> <p><a href="../blog" class=""><span class="emoji">‚¨ÖÔ∏è</span> There's more to read on the blog overview</a></p> </div> <div class="grid-x grid-padding-x margin-top-xlarge padding-bottom-xlarge"> <div class="cell medium-12 callout small"> <h3>I'm Ken Hawkins</h3> <p>I do web architecture, holistic design, and a bit of UX and development.<br> If you want to learn more about me and what I do <a href="../">head to the front page</a>, or:</p> <div class="margin-left-medium"> <ul class="no-bullet"> <li class="">&nbsp; <span class="emoji">üê¶</span> <a href="https://twitter.com/khawkins98">Twitter<span class="show-for-large"> @khawkins98</span></a></li> <li class="">&nbsp; <span class="emoji">üì¨</span> <a href="..//rss.xml">RSS feed</a></li> <li class="">&nbsp; <span class="emoji">üìà</span> <a href="https://www.linkedin.com/in/allaboutken">LinkedIn</a></li> <li class="show-for-medium-only">&nbsp; <span class="emoji">‚úâÔ∏è</span> <a href="mailto:khawkins98@gmail.com">E-mail</a></li> <li class="show-for-large">&nbsp; <span class="emoji">‚úâÔ∏è</span> <a href="mailto:khawkins98@gmail.com">khawkins98@gmail.com</a></li> </ul> </div> </div> <div class="cell medium-12"> <h3>This site is a playground <span class="emoji">üôà</span></h3> <p>What you're seeing was made with a combination <sup><a href="https://github.com/khawkins98/allaboutken/blob/master/gulpfile.js">1</a></sup> <sup><a href="https://github.com/khawkins98/allaboutken/blob/master/package.json">2</a></sup> of the Foundation Framework, CSS/Sass, responsive design, Gulp, Panini static site generator, Markdown and some other stuff and then hosted through Travis CI and Github pages<sup><a href="https://github.com/khawkins98/allaboutken/blob/master/.travis.yml">3</a></sup>.</p> <p>In years past I would have likely made this site with Drupal, but for smaller sites with savvy editors I've been using static site combinations to simplify maintenance.</p> </div> </div> </div> </div> <div class="small-12 do-not-print cell"> <p><a class="float-right small" href="/privacy">Curious about privacy?</a></p> </div> <code class="show-for-print-only small">Printed direct from AllAboutKen.com</code> </div> </body> </html> 